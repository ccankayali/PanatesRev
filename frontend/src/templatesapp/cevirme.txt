import React from 'react';
import './pure.css';
import { useNavigate } from 'react-router-dom';
import { Login } from './login';
import { SignUp } from './signup';

export function Pure() {
    const [variable , setVariable] = React.useState('login');
    const navigate = useNavigate();

    const changeVariableLogin = () => {
        setVariable('login');
    }

    const changeVariableSignup = () => {
        setVariable('signup');
    }

    const handleSubmit = async (e) => {
        e.preventDefault();
        try {
            const response = await fetch('http://localhost:3000/auth/login_user', { 
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    email: e.target.logemail.value,
                    password: e.target.logpass.value
                })
            });
            const data = await response.json();
            console.log(data); // Handle response data as needed
             if(response.status === 201){
                navigate('/mainpage');
              } else{
                navigate('/');
        
              }// Redirect to sign-up page after successful login
        } catch (error) {
            navigate('/');
            console.log(error); // Handle error as needed
        }
    };

    const handleSignUp = async (e) => {
        e.preventDefault();
        try {
            const response = await fetch('http://localhost:3000/auth/signup_user', { 
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    name: e.target.logname.value,
                    email: e.target.logemail.value,
                    password: e.target.logpass.value
                })
            });
            const data = await response.json();
            console.log(data); // Handle response data as needed
            navigate('/pure'); // Redirect to login page after successful sign-up
        } catch (error) {
            console.log(error); // Handle error as needed
        }
    };

    return (
        <div>
            <button onClick={changeVariableLogin}>login</button>
            <button onClick={changeVariableSignup}>signup</button>
            {variable === "login" ? (
                <Login/>
            ) : (
                <SignUp/>
            )}
        </div>
    );
}
